---
import MarkdownLayout from '../../layouts/MarkdownLayout.astro';
import Gallery from '@core/components/Gallery/Gallery.astro';
import Example from '../../components/Example.astro';
import TableOfContents from '@core/components/TableOfContents.astro';

const frontmatter = {
  title: "Gallery Component Demo",
  date: "2025-11-14",
  description: "Display responsive photo galleries with lightbox functionality powered by PhotoSwipe"
};
---

<MarkdownLayout frontmatter={frontmatter}>
  <h1>Gallery Component</h1>

  <p>The <strong>Gallery</strong> component displays images in a responsive grid layout with PhotoSwipe lightbox functionality. It automatically loads images from a <code>gallery/</code> subfolder and supports custom captions, sorting options, and responsive column configuration.</p>

  <TableOfContents title="Gallery examples on this page" />

  <hr />

  <h2>Key Features</h2>
  
  <ul>
    <li>üì∏ <strong>PhotoSwipe Integration</strong> - Full-screen lightbox with zoom, pan, and swipe gestures</li>
    <li>üîÑ <strong>Auto-loading</strong> - Automatically discovers images in <code>gallery/</code> folders</li>
    <li>üìù <strong>Custom Captions</strong> - Support for <code>captions.json</code> file or auto-generated from filenames</li>
    <li>üé® <strong>Responsive Grid</strong> - Configurable columns that adapt to screen size</li>
    <li>‚ö° <strong>Optimized Images</strong> - Astro's image optimization for fast loading</li>
    <li>‚å®Ô∏è <strong>Keyboard Navigation</strong> - Arrow keys, ESC, and full accessibility support</li>
  </ul>

  <hr />

  <Example title="Default usage (auto-loading from gallery/ folder)">
    <Fragment slot="intro">
      The component automatically looks for images in a <code>gallery/</code> subfolder based on the current page path. 
      <br /><br />
      For example, if your page is at <code>/gallery-demo/</code>, the gallery will display images from <code>/gallery-demo/gallery/*.{`{jpg,jpeg,png,gif,webp,avif}`}</code>.
      <br /><br />
      <strong>Custom Captions:</strong> This demo uses a <code>captions.json</code> file in the gallery folder to provide descriptive captions instead of auto-generated ones from filenames.
    </Fragment>

    <Fragment slot="code">
      ```jsx
      <Gallery />
      ```
    </Fragment>

    <Gallery />
  </Example>

  <details style="margin-top: 1rem;">
    <summary><strong>üìÑ View captions.json structure</strong></summary>
    <p>Place this file in your <code>gallery/</code> folder to provide custom captions:</p>
    <pre><code>{`{
  "children-593313_1920.jpg": "Two excited children raising their hands in joy",
  "coffee-2306471_1920.jpg": "A perfect cappuccino with beautiful latte art",
  "entrepreneur-593371_1920.jpg": "Young entrepreneurs celebrating their success",
  "home-office-336378_1920.jpg": "Productive workspace with coffee and laptop",
  "notebook-336634_1920.jpg": "Clean desk setup with notebook and writing tools"
}`}</code></pre>
    <p><em>Tip: Keys can be filenames with or without extensions. Missing captions fall back to auto-generated ones.</em></p>
  </details>

  <p style="margin-top: 2rem;"><small>Images by <a href="https://pixabay.com/users/freephotocc-2275370/" target="_blank" rel="noopener">Pixabay</a></small></p>

  <hr />

  <Example title="Custom path example">
    <Fragment slot="intro">
      Override the default path behavior to load images from a different gallery folder using the <code>path</code> prop:
    </Fragment>

    <Fragment slot="code">
      ```jsx
      <Gallery path="/image-gallery" />
      ```
    </Fragment>

    <Gallery path="/image-gallery" />
  </Example>

  <hr />

  <Example title="Reverse sorting">
    <Fragment slot="intro">
      Images are sorted alphabetically by filename in descending order by default. Use <code>reverseSorting</code> to reverse this order:
    </Fragment>

    <Fragment slot="code">
      ```jsx
      <Gallery reverseSorting />
      ```
    </Fragment>

    <Gallery reverseSorting />
  </Example>

  <hr />

  <Example title="Custom column configuration">
    <Fragment slot="intro">
      Control the responsive grid by specifying minimum and maximum columns. The grid will adapt between these values based on screen width:
    </Fragment>

    <Fragment slot="code">
      ```jsx
      <Gallery 
        columns={{ min: 2, max: 4 }}
      />
      ```
    </Fragment>

    <Gallery columns={{ min: 2, max: 4 }} />
  </Example>

  <hr />

  <h2>Usage in MDX Files</h2>

  <p>For MDX files, use <code>GalleryMdx</code> with <code>import.meta.glob</code> to load images:</p>

  <pre><code>{`import { GalleryMdx, processGalleryImages } from '@core/components/Gallery';

export const images = import.meta.glob(
  './gallery/*.{jpg,jpeg,png,gif,webp,avif}', 
  { eager: true }
);

// Optional: Add custom captions
export const captions = {
  "photo1.jpg": "Custom caption for photo 1",
  "photo2.jpg": "Custom caption for photo 2"
};

<GalleryMdx 
  images={processGalleryImages(images, { captions })} 
  client:idle 
/>`}</code></pre>

  <p><strong>Note:</strong> The <code>import.meta.glob</code> path must be a static string literal and relative to the current MDX file.</p>

  <hr />

  <h2>Component API</h2>

  <h3>Props</h3>

  <table>
    <thead>
      <tr>
        <th>Prop</th>
        <th>Type</th>
        <th>Default</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>string</code></td>
        <td>Current page path</td>
        <td>Custom path to gallery folder</td>
      </tr>
      <tr>
        <td><code>reverseSorting</code></td>
        <td><code>boolean</code></td>
        <td><code>false</code></td>
        <td>Reverse the default sort order</td>
      </tr>
      <tr>
        <td><code>columns</code></td>
        <td><code>{`{ min?: number, max?: number }`}</code></td>
        <td><code>{`{ min: 1, max: 3 }`}</code></td>
        <td>Min and max columns for responsive grid</td>
      </tr>
      <tr>
        <td><code>className</code></td>
        <td><code>string</code></td>
        <td><code>undefined</code></td>
        <td>Additional CSS classes</td>
      </tr>
      <tr>
        <td><code>images</code></td>
        <td><code>GalleryImage[]</code></td>
        <td><code>undefined</code></td>
        <td>Manual image array (overrides auto-loading)</td>
      </tr>
    </tbody>
  </table>

  <h3>GalleryImage Type</h3>

  <pre><code>{`interface GalleryImage {
  src: string;        // Full-size image URL
  thumb: string;      // Thumbnail URL (can be same as src)
  width: number;      // Image width in pixels
  height: number;     // Image height in pixels
  alt: string;        // Alt text for accessibility
  caption?: string;   // Optional caption for lightbox
}`}</code></pre>

  <hr />

  <h2>Folder Structure</h2>

  <pre><code>{`pages/
  gallery-demo/
    index.astro          # Your page
    gallery/
      photo1.jpg
      photo2.jpg
      photo3.jpg
      captions.json      # Optional custom captions`}</code></pre>

  <p>The component automatically discovers all supported image formats (<code>.jpg, .jpeg, .png, .gif, .webp, .avif</code>) in the gallery folder.</p>
</MarkdownLayout>

